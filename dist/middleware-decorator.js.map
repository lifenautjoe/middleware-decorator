{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap b5f0a9841806c4cef9c1","webpack:///./src/index.js","webpack:///./src/synchronous-middleware-runner.js","webpack:///./src/asynchronous-middleware-runner.js","webpack:///./src/promised-middleware-runner.js"],"names":["middlewareDecoratorFactory","middlewareRunner","middlewareDecorator","f","decoratedF","_middleware","run","arguments","use","middleware","async","promised","module","exports","SynchronousMiddlewareRunner","_middlewares","_f","middlewares","input","length","nextMiddleware","shift","nextMiddlewareOutput","_digest","Error","push","fOutput","_runFWithArgs","slice","AsynchronousMiddlewareRunner","onDigested","undefined","that","next","digestionOutput","cb","runCb","output","_cb","PromisedMiddlewareRunner","value","then","_isPromise","nextMiddlewareResolution","fResolution"],"mappings":"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","file":"middleware-decorator.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"middlewareDecorator\"] = factory();\n\telse\n\t\troot[\"middlewareDecorator\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap b5f0a9841806c4cef9c1\n **/","/**\n * Created on 11/12/16.\n * @author Joel Hernandez <joel.hernandez@kpn.com>\n */\n\nimport SynchronousMiddlewareRunner from './synchronous-middleware-runner';\nimport AsynchronousMiddlewareRunner from './asynchronous-middleware-runner';\nimport PromisedMiddlewareRunner from './promised-middleware-runner';\n\n/**\n * @typedef {Function} functionMiddleware~use\n * @param {Function} middleware\n */\n\n/**\n * @typedef {Function} functionMiddleware\n * @property {functionMiddleware~use} use\n */\n\n\n/**\n * Generates middleware runner decorators with the given middlewareRunner\n * @param {Function} middlewareRunner\n * @returns {middlewareRunner}\n */\nfunction middlewareDecoratorFactory(middlewareRunner) {\n    /**\n     * Decorates the given function with middleware functionality\n     * @param {Function} f\n     * @returns {functionMiddleware}\n     */\n    return function middlewareDecorator(f) {\n        function decoratedF() {\n            return decoratedF._middleware.run(...arguments);\n        }\n\n        decoratedF._middleware = new middlewareRunner(f);\n\n        decoratedF.use = function (middleware) {\n            decoratedF._middleware.use(middleware)\n        };\n\n        return decoratedF;\n    }\n}\n\nconst middlewareDecorator = middlewareDecoratorFactory(SynchronousMiddlewareRunner);\nmiddlewareDecorator.async = middlewareDecoratorFactory(AsynchronousMiddlewareRunner);\nmiddlewareDecorator.promised = middlewareDecoratorFactory(PromisedMiddlewareRunner);\n\nmodule.exports = middlewareDecorator;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","export default class SynchronousMiddlewareRunner {\n\n    constructor(f) {\n        this._middlewares = [];\n        this._f = f;\n    }\n\n    _digest(middlewares, input) {\n        if (middlewares.length === 0) return input;\n        const nextMiddleware = middlewares.shift();\n        const nextMiddlewareOutput = nextMiddleware(input);\n        return this._digest(middlewares, nextMiddlewareOutput);\n    }\n\n    use(middleware) {\n        if (typeof middleware !== \"function\") throw new Error('middleware:function is required');\n        this._middlewares.push(middleware);\n    }\n\n    _runFWithArgs(...args) {\n        return this._f(...args);\n    }\n\n    run(...args) {\n        const fOutput = this._runFWithArgs(...args);\n        if (this._middlewares.length === 0) return fOutput;\n        return this._digest(this._middlewares.slice(), fOutput)\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/synchronous-middleware-runner.js\n **/","/**\n * Created on 11/12/16.\n * @author Joel Hernandez <joel.hernandez@kpn.com>\n */\nimport SynchronousMiddlewareRunner from './synchronous-middleware-runner';\n\nexport default class AsynchronousMiddlewareRunner extends SynchronousMiddlewareRunner {\n\n    _digest(middlewares, input, onDigested) {\n        if (middlewares.length === 0) return onDigested(undefined, input);\n        const nextMiddleware = middlewares.shift();\n\n        const that = this;\n\n        function next(nextMiddlewareOutput) {\n            if (nextMiddlewareOutput instanceof Error) {\n                onDigested(nextMiddlewareOutput);\n            } else {\n                that._digest(middlewares, nextMiddlewareOutput, onDigested);\n            }\n        }\n\n        nextMiddleware(input, next);\n    }\n\n    run(...args) {\n        const fOutput = this._runFWithArgs(...args);\n        let digestionOutput;\n        let cb;\n\n        function runCb() {\n            if (digestionOutput && cb) cb(...digestionOutput);\n        }\n\n        function onDigested(...output) {\n            digestionOutput = output;\n            runCb();\n        }\n\n        this._digest(this._middlewares.slice(), fOutput, onDigested);\n        return {\n            cb: function (_cb) {\n                if (typeof _cb !== \"function\") throw new Error('_cb:function is required');\n                cb = _cb;\n                runCb();\n            }\n        }\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/asynchronous-middleware-runner.js\n **/","/**\n * Created on 11/12/16.\n * @author Joel Hernandez <joel.hernandez@kpn.com>\n */\nimport FunctionMiddleware from './synchronous-middleware-runner';\n\nexport default class PromisedMiddlewareRunner extends FunctionMiddleware {\n\n    /**\n     * Checks if the given value is a promise\n     * @param {Object} value\n     * @returns {boolean}\n     * @private\n     */\n    _isPromise(value) {\n        return typeof value.then === 'function';\n    }\n\n    _digest(middlewares, input) {\n        if (middlewares.length === 0) return input;\n        const nextMiddleware = middlewares.shift();\n        const nextMiddlewareOutput = nextMiddleware(input);\n\n        if (this._isPromise(nextMiddlewareOutput)) {\n            return nextMiddlewareOutput.then((nextMiddlewareResolution) => {\n                return this._digest(middlewares, nextMiddlewareResolution);\n            });\n        }\n        return this._digest(middlewares, nextMiddlewareOutput);\n    }\n\n    /**\n     * @param args\n     * @returns {Promise}\n     */\n    run(...args) {\n        /**\n         * @type {Promise}\n         */\n        const fOutput = this._runFWithArgs(...args);\n        if (this._middlewares.length === 0) return fOutput;\n        return fOutput.then((fResolution) => {\n            return this._digest(this._middlewares.slice(), fResolution)\n        });\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/promised-middleware-runner.js\n **/"],"sourceRoot":""}